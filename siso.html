<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Siso - ë§ì¶¤ ì¶”ì²œ ê²°ê³¼</title>
    <style>
        body { margin: 0; font-family: sans-serif; background-color: #f8f9fa; }
        .navbar { display: flex; justify-content: space-between; align-items: center; padding: 15px 5%; background-color: white; border-bottom: 1px solid #eee; }
        .nav-logo { font-size: 1.8rem; font-weight: bold; color: #007bff; }
        .nav-menu a { text-decoration: none; color: #333; margin: 0 15px; }
        .nav-actions { display: flex; align-items: center; gap: 15px; }
        .nav-actions a { text-decoration: none; color: #333; }
        .nav-actions .login-btn { background-color: #007bff; color: white; padding: 8px 15px; border-radius: 5px; }
        .main-content { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        .page-title { text-align: center; font-size: 1.8rem; font-weight: bold; color: #333; margin-bottom: 10px; }
        .page-subtitle { text-align: center; color: #888; margin-bottom: 30px; }
        .filter-summary-bar { display: flex; flex-wrap: wrap; gap: 15px; align-items: center; background-color: #e7f1ff; color: #0056b3; padding: 15px 20px; border-radius: 8px; margin-bottom: 30px; }
        .summary-item { display: flex; align-items: center; gap: 8px; font-weight: 500; }
        .results-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; }
        .item-card { background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); overflow: hidden; position: relative; }
        .item-card img { width: 100%; height: 200px; object-fit: cover; display: block; }
        .item-card .heart { position: absolute; top: 15px; right: 15px; font-size: 1.5rem; color: white; text-shadow: 0 0 5px rgba(0,0,0,0.5); cursor: pointer; }
        .card-content { padding: 20px; }
        .card-content .tags { font-size: 0.9rem; color: #666; margin-bottom: 10px; }
        .card-content h3 { margin: 0 0 10px; font-size: 1.2rem; }
        .card-content .price { font-size: 1.3rem; font-weight: bold; color: #333; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-logo">SISO</div>
        <div class="nav-menu"><a href="#">ì—¬í–‰</a><a href="#">í´ë˜ìŠ¤</a><a href="#">ì‹œì†Œì±—</a><a href="#">ê³ ê°ì„¼í„°</a></div>
        <div class="nav-actions"><a href="/search">ğŸ”</a><a href="#">ì˜ˆì•½ ê²€ìƒ‰</a><a href="/" class="login-btn">ë¡œê·¸ì•„ì›ƒ</a></div>
    </nav>
    <main class="main-content">
        <h2 id="page-title" class="page-title">ë¶„ì„ ì¤‘...</h2>
        <p class="page-subtitle">ë‹¤ìŒê³¼ ê°™ì€ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë§ì¶¤ ì¼ì •ì„ ì œì‹œí•  ê±°ì˜ˆìš” ğŸ“¦</p>
        
        <div id="filter-summary-bar" class="filter-summary-bar">
            <!-- ìš”ì•½ ì •ë³´ëŠ” JSë¡œ ë™ì ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
        </div>
        
        <div id="results-grid" class="results-grid">
            <!-- ì¶”ì²œ ê²°ê³¼ ì¹´ë“œëŠ” JSë¡œ ë™ì ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
        </div>
    </main>

    <script>
        window.onload = async function() {
            // 1. í˜„ì¬ í˜ì´ì§€ì˜ URLì—ì„œ ì‚¬ìš©ìê°€ ì„ íƒí•œ í•„í„° ê°’ë“¤ì„ ì½ì–´ì˜µë‹ˆë‹¤.
            const params = new URLSearchParams(window.location.search);
            const region = params.get('region');
            const itemType = params.get('item_type');
            const keywords = params.get('keywords');

            // 2. ì½ì–´ì˜¨ ê°’ë“¤ì„ ìƒë‹¨ì˜ íŒŒë€ìƒ‰ ìš”ì•½ ë°”ì— í‘œì‹œí•©ë‹ˆë‹¤.
            const summaryBar = document.getElementById('filter-summary-bar');
            let summaryHTML = '';
            if (region) summaryHTML += `<div class="summary-item">ğŸ“ ${region}</div>`;
            if (itemType) summaryHTML += `<div class="summary-item">ğŸ·ï¸ ${itemType}</div>`;
            if (keywords) summaryHTML += `<div class="summary-item">ğŸ’¬ ${keywords}</div>`;
            summaryBar.innerHTML = summaryHTML;
            
            // 3. ë°±ì—”ë“œ APIë¥¼ í˜¸ì¶œí•˜ì—¬ ë§ì¶¤ ì¶”ì²œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
            try {
                const response = await fetch(`/wizard/recommendations?${params.toString()}`);
                const data = await response.json();
                
                // 4. ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ í™”ë©´ì— ë Œë”ë§í•©ë‹ˆë‹¤.
                const pageTitle = document.getElementById('page-title');
                pageTitle.textContent = `ì‹œì†Œì—ì„œ ê°€ì¥ ì¢‹ì€ ì¼ì • ${data.results.length}ê°œë¥¼ ì„¸ì› ì–´ìš” :-)`;
                
                const grid = document.getElementById('results-grid');
                grid.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš©ì„ ì´ˆê¸°í™”
                
                data.results.forEach(item => {
                    const cardHTML = `
                        <div class="item-card">
                            <img src="https://i.ibb.co/LgB4FkC/profile.jpg" alt="${item.title}">
                            <span class="heart">â™¡</span>
                            <div class="card-content">
                                <p class="tags">${item.tags.join(' ')}</p>
                                <h3>${item.title}</h3>
                                <p class="price">${item.price.toLocaleString()}ì›~</p>
                            </div>
                        </div>
                    `;
                    grid.innerHTML += cardHTML;
                });

            } catch (error) {
                console.error("ì¶”ì²œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:", error);
                document.getElementById('page-title').textContent = "ì¶”ì²œì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
            }
        };
    </script>
</body>
</html>
